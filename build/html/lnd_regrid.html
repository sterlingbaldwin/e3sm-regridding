

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Land Regridding &mdash; e3sm-regridding 1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MPAS Regridding" href="mpas_regrid.html" />
    <link rel="prev" title="Atmospheric Regridding" href="atm_regrid.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> e3sm-regridding
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="atm_regrid.html">Atmospheric Regridding</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Land Regridding</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#regridding-elm-clm-land-data-diles">Regridding ELM/CLM land data diles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mpas_regrid.html">MPAS Regridding</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">e3sm-regridding</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Land Regridding</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lnd_regrid.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="land-regridding">
<span id="lnd-regrid"></span><h1>Land Regridding<a class="headerlink" href="#land-regridding" title="Permalink to this headline">¶</a></h1>
<div class="section" id="regridding-elm-clm-land-data-diles">
<h2>Regridding ELM/CLM land data diles<a class="headerlink" href="#regridding-elm-clm-land-data-diles" title="Permalink to this headline">¶</a></h2>
<p>A simple example, regridding a directory of ne30 cam.h0 files. This will regrid all variables in the input files, using sub-grid-scale
regridding, which uses the land fraction around coastal areas to better represent the values around complex coastal geometry.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">mapfile</span><span class="o">=</span>map_ne30np4_to_cmip6_180x360_aave.20181001.nc
<span class="nv">drc_in</span><span class="o">=</span>./clm2.h0/
<span class="nv">drc_out</span><span class="o">=</span>./180x360/
<span class="nv">land_file</span><span class="o">=</span>&lt;input file path&gt; <span class="c1"># this is the path to a single land file to pull the landfrac variable from</span>

ncremap -m <span class="si">${</span><span class="nv">mapfile</span><span class="si">}</span> -I <span class="si">${</span><span class="nv">src_in</span><span class="si">}</span> -O <span class="si">${</span><span class="nv">drc_out</span><span class="si">}</span> --sgs_frac<span class="o">=</span><span class="si">${</span><span class="nv">land_file</span><span class="si">}</span>/landfrac
</pre></div>
</div>
<p>In this medium complexity example, the same regridding operation as above is performed, but only on the DEADSTEMC and CDWC variables.
Running with specific variables selected significantly speeds up the run, as the rest of the variables are ignored.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">mapfile</span><span class="o">=</span>map_ne30np4_to_cmip6_180x360_aave.20181001.nc
<span class="nv">drc_in</span><span class="o">=</span>./cam.h0/
<span class="nv">drc_out</span><span class="o">=</span>./180x360/
<span class="nv">vars</span><span class="o">=</span><span class="s2">&quot;DEADSTEMC,CDWC&quot;</span>

ncremap -v <span class="si">${</span><span class="nv">vars</span><span class="si">}</span> -m <span class="si">${</span><span class="nv">mapfile</span><span class="si">}</span> -I <span class="si">${</span><span class="nv">src_in</span><span class="si">}</span> -O <span class="si">${</span><span class="nv">drc_out</span><span class="si">}</span>
</pre></div>
</div>
<p>In this more complex example, the regridding operation is performed and the selected variables are output in single-variable-per-file time-series files.
The output will be compressed and deflated. The model data starts at 1850-01 and ends at 2014-12.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="nv">mapfile</span><span class="o">=</span>map_ne30np4_to_cmip6_180x360_aave.20181001.nc
<span class="nv">drc_in</span><span class="o">=</span>./clm2.h0/
<span class="nv">drc_out</span><span class="o">=</span>./180x360/
<span class="nv">vars</span><span class="o">=</span><span class="s2">&quot;DEADSTEMC,CDWC&quot;</span>               <span class="c1"># comma separated variable list</span>
<span class="nv">start</span><span class="o">=</span><span class="m">1850</span>                          <span class="c1"># the first year of model data</span>
<span class="nv">end</span><span class="o">=</span><span class="m">2014</span>                            <span class="c1"># the last year of model data</span>
<span class="nv">land_file</span><span class="o">=</span>&lt;input file path&gt;         <span class="c1"># this is the path to a single land file to pull the landfrac variable from</span>
<span class="nv">format_flags</span><span class="o">=</span><span class="s2">&quot;-7 --dfl_lvl=1&quot;</span>       <span class="c1"># compression and deflation</span>

<span class="nb">cd</span> <span class="si">${</span><span class="nv">drc_in</span><span class="si">}</span><span class="p">;</span>
ls *.nc <span class="p">|</span> ncclimo --dbg<span class="o">=</span><span class="m">1</span> --var<span class="o">=</span><span class="si">${</span><span class="nv">vars</span><span class="si">}</span> <span class="si">${</span><span class="nv">format_flags</span><span class="si">}</span> --yr_srt<span class="o">=</span><span class="si">${</span><span class="nv">start</span><span class="si">}</span> --yr_end<span class="o">=</span><span class="si">${</span><span class="nv">end</span><span class="si">}</span> -O<span class="o">=</span><span class="si">${</span><span class="nv">dir_out</span><span class="si">}</span> --map<span class="o">=</span><span class="si">${</span><span class="nv">mapfile</span><span class="si">}</span> --sgs_frac<span class="o">=</span><span class="si">${</span><span class="nv">land_file</span><span class="si">}</span>/landfrac
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mpas_regrid.html" class="btn btn-neutral float-right" title="MPAS Regridding" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="atm_regrid.html" class="btn btn-neutral float-left" title="Atmospheric Regridding" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Sterling Baldwin

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>